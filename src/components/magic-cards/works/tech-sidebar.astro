---
import MagicCardLayout from "src/layouts/magic-card-layout";

let activeTechIds: string[] = [];

const allTechnologies = [
  { id: "react", name: "React", icon: "react-icon" },
  { id: "nextjs", name: "Next.js", icon: "nextjs-icon" },
  { id: "vue", name: "Vue", icon: "vue-icon" },
  { id: "angular", name: "Angular", icon: "angular-icon" },
  { id: "svelte", name: "Svelte", icon: "svelte-icon" },
  { id: "astro", name: "Astro", icon: "astro-icon" },
  { id: "tailwind", name: "Tailwind CSS", icon: "tailwind-icon" },
  { id: "typescript", name: "TypeScript", icon: "typescript-icon" },
  { id: "javascript", name: "JavaScript", icon: "javascript-icon" },
  { id: "node", name: "Node.js", icon: "node-icon" },
  { id: "python", name: "Python", icon: "python-icon" },
  { id: "laravel", name: "Laravel", icon: "laravel-icon" },
  { id: "livewire", name: "Livewire", icon: "livewire-icon" },
  { id: "alpinejs", name: "Alpine.js", icon: "alpinejs-icon" },
  { id: "php", name: "PHP", icon: "php-icon" },
  { id: "prisma", name: "Prisma", icon: "prisma-icon" },
  { id: "nextauth", name: "NextAuth", icon: "nextauth-icon" },
  { id: "postgresql", name: "PostgreSQL", icon: "postgresql-icon" },
  { id: "langchain", name: "Langchain", icon: "langchain-icon" },
  { id: "frankenphp", name: "FrankenPHP", icon: "frankenphp-icon" },
  { id: "docker", name: "Docker", icon: "docker-icon" },
];
---

<MagicCardLayout initial={{ opacity: 0, x: -20 }} className="size-full" client:load>
  <div class="p-4">
    <h2 class="text-xl font-bold mb-4">Technologies</h2>
  
    <div class="gap-2 grid grid-cols-2">
      {allTechnologies.map((tech) => (
        <div
          class:list={[
            "p-2 rounded border transition-all duration-300 text-center text-xs md:text-sm",
            activeTechIds.includes(tech.id)
              ? "border-foreground text-foreground bg-background"
              : "border-border text-gray-300"
          ]}
          data-tech-id={tech.id}
        >
          <span>{tech.name}</span>
        </div>
      ))}
    </div>
  </div>
</MagicCardLayout>

<script>
  document.addEventListener('projectInView', (event) => {
    const techIds = (event as CustomEvent).detail.technologies;
    const techElements = document.querySelectorAll('[data-tech-id]');
    
    techElements.forEach(element => {
      const techId = element.getAttribute('data-tech-id');
      if (techIds.includes(techId)) {
        element.classList.add('border-foreground', 'text-foreground', 'bg-background', 'font-semibold');
      } else {
        element.classList.remove('border-foreground', 'text-foreground', 'bg-background', 'font-semibold');
      }
    });
  });
</script>